<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intern Operations System</title>

    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/layout.css">
    <link rel="stylesheet" href="./css/components.css">
</head>

<body>
    <!-- Login Screen (Shows initially) -->
    <div id="login-screen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <h1>ðŸŽ“ Intern Operations System</h1>
                <p id="auth-subtitle">Please login or create an account</p>
            </div>

            <!-- Login Form -->
            <div id="login-form-container" class="auth-form-container">
                <h2>Login</h2>
                <div id="login-error"></div>
                <form id="login-form" class="auth-form" method="post">
                    <div class="form-group">
                        <label>Username *</label>
                        <input type="text" name="username" placeholder="Enter username" required
                            autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label>Password *</label>
                        <input type="password" name="password" placeholder="Enter password" required
                            autocomplete="current-password">
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Login</button>
                </form>
                <p class="auth-switch">
                    Don't have an account? <a href="#" onclick="Auth.showSignup(); return false;">Sign up</a>
                </p>
            </div>

            <!-- Signup Form -->
            <div id="signup-form-container" class="auth-form-container" style="display: none;">
                <h2>Create Account</h2>
                <div id="signup-error"></div>
                <form id="signup-form" class="auth-form" method="post">
                    <div class="form-group">
                        <label>Full Name *</label>
                        <input type="text" name="fullname" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label>Username *</label>
                        <input type="text" name="username" placeholder="Choose a username" required
                            autocomplete="username">
                        <small>Username must be 3-20 characters</small>
                    </div>
                    <div class="form-group">
                        <label>Password *</label>
                        <input type="password" name="password" placeholder="Choose a password" required
                            autocomplete="new-password">
                        <small>Password must be at least 6 characters</small>
                    </div>
                    <div class="form-group">
                        <label>Role *</label>
                        <select name="role" required>
                            <option value="">Select your role</option>
                            <option value="ADMIN">Admin - Full system access</option>
                            <option value="MANAGER">Manager - Task management</option>
                            <option value="INTERN">Intern - View your tasks</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Create Account</button>
                </form>
                <p class="auth-switch">
                    Already have an account? <a href="#" onclick="Auth.showLogin(); return false;">Login</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Main Application (Hidden initially) -->
    <div id="main-app" class="container" style="display: none;">
        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h1>ðŸŽ“ Intern Operations System</h1>
                    <p>Advanced State Management with Dependency Resolution</p>
                </div>
                <div style="text-align: right;">
                    <p style="margin-bottom: 5px; font-size: 0.9em;">
                        Logged in as: <strong id="current-user-name"></strong>
                    </p>
                    <p style="margin-bottom: 10px; font-size: 0.9em;">
                        Role: <strong id="current-user-role"></strong>
                    </p>
                    <button class="btn btn-secondary" onclick="Auth.logout()"
                        style="font-size: 0.85em; padding: 6px 12px;">
                        ðŸšª Logout
                    </button>
                </div>
            </div>
        </div>

        <div class="nav" id="main-nav">
            <!-- Navigation will be rendered based on role -->
        </div>

        <!-- Dashboard View -->
        <div id="dashboard" class="view active">
            <div class="stats" id="stats"></div>
            <div class="card">
                <h2>System Overview</h2>
                <p style="line-height: 1.6; color: #495057;">
                    This system demonstrates complex business logic implemented entirely in JavaScript:
                </p>
                <ul style="margin-top: 15px; margin-left: 20px; line-height: 1.8; color: #495057;">
                    <li>âœ… Auto-generated intern IDs (Year + Sequence)</li>
                    <li>âœ… Async email uniqueness validation</li>
                    <li>âœ… Skill-based task assignment</li>
                    <li>âœ… Task dependency management</li>
                    <li>âœ… Circular dependency detection</li>
                    <li>âœ… Automatic status updates</li>
                    <li>âœ… Dynamic hour calculation</li>
                    <li>âœ… Role-based access control</li>
                </ul>
            </div>
        </div>

        <!-- Interns View -->
        <div id="interns" class="view">
            <!-- Create Intern Form (Only for ADMIN) -->
            <div class="card" id="create-intern-card">
                <h2>Add New Intern</h2>
                <div id="intern-error"></div>
                <form id="intern-form" method="post">
                    <div class="form-group">
                        <label>Full Name *</label>
                        <input type="text" name="name" placeholder="John Doe" required>
                    </div>
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" name="email" placeholder="john.doe@example.com" required>
                        <small>Email uniqueness will be checked asynchronously</small>
                    </div>
                    <div class="form-group">
                        <label>Skills (comma-separated) *</label>
                        <input type="text" name="skills" placeholder="JavaScript, React, Node.js" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Create Intern</button>
                </form>
            </div>

            <div class="card">
                <h2>Intern List</h2>
                <div class="filter-bar">
                    <select id="status-filter">
                        <option value="all">All Statuses</option>
                        <option value="ONBOARDING">Onboarding</option>
                        <option value="ACTIVE">Active</option>
                        <option value="EXITED">Exited</option>
                    </select>
                    <select id="skill-filter">
                        <option value="all">All Skills</option>
                    </select>
                </div>
                <div id="intern-list" class="intern-grid"></div>
            </div>
        </div>

        <!-- Tasks View -->
        <div id="tasks" class="view">
            <!-- Create Task Form (Only for ADMIN) -->
            <div class="card" id="create-task-card">
                <h2>Create New Task</h2>
                <div id="task-error"></div>
                <form id="task-form" method="post">
                    <div class="form-group">
                        <label>Task Title *</label>
                        <input type="text" name="title" placeholder="Build landing page" required>
                    </div>
                    <div class="form-group">
                        <label>Description *</label>
                        <textarea name="description" rows="3"
                            placeholder="Create a responsive landing page with modern design..." required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Required Skills (comma-separated) *</label>
                        <input type="text" name="skills" placeholder="HTML, CSS, JavaScript" required>
                    </div>
                    <div class="form-group">
                        <label>Estimated Hours *</label>
                        <input type="number" name="hours" min="1" max="200" value="5" required>
                    </div>
                    <div class="form-group">
                        <label>Dependencies (Task IDs, comma-separated)</label>
                        <input type="text" name="dependencies" placeholder="TASK_001, TASK_002">
                        <small>Leave empty if no dependencies. Circular dependencies will be blocked.</small>
                    </div>
                    <button type="submit" class="btn btn-primary">Create Task</button>
                </form>
            </div>

            <div class="card">
                <h2 id="task-list-header">Task List</h2>
                <ul id="task-list" class="task-list"></ul>
            </div>
        </div>

        <!-- Logs View -->
        <div id="logs" class="view">
            <div class="card">
                <h2>Activity Logs</h2>
                <div id="log-list"></div>
            </div>
        </div>
    </div>

    <!-- Load JavaScript files in correct order -->
    <script src="./js/state.js"></script>
    <script src="./js/fake-server.js"></script>
    <script src="./js/validators.js"></script>
    <script src="./js/rules-engine.js"></script>
    <script src="./js/renderer.js"></script>
    <script src="./js/app.js"></script>
</body>

</html>